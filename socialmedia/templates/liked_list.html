{% extends 'layout.html' %}

{% block content %}
<div class="container mt-4">
    
    {% if view_like %}
    <main role="main" class="main-content">
         <h1 class="h2 font-bold gradient-text">Your Liked Posts</h1>
        <h2></h2>
    <div class="container-fluid" id="gridView">
        <div class="explore-grid">
            {% for pos in view_like %}
            <article class="post-card">
                <!-- Header -->
                <header class="post-card__header">
                    <img src="{{pos.profileimg}}" 
                         alt="{{pos.user}}'s profile picture" 
                         class="post-card__avatar">
                    <div class="post-card__user-info">
                        <a href="/profile/{{pos.user}}" class="post-card__username">
                            @{{pos.user}}
                        </a>
                        <time class="post-card__timestamp">
                            {{pos.created_at|timesince}} ago
                        </time>
                    </div>
                    <div class="post-card__actions">
                        <button class="post-card__action-btn" title="More options">
                            <i class="fas fa-ellipsis-h"></i>
                        </button>
                    </div>
                </header>
                
                <!-- Content -->
                <div class="post-card__content">
                    {% if pos.caption %}
                    <p class="post-card__caption">{{pos.caption}}</p>
                    {% endif %}
                    
                    {% if pos.image %}
                    <div class="post-card__media-container">
                       <img src="{{ pos.image.url }}"
                            class="post-card__image"
                            style="cursor:pointer;">



                        <div class="post-card__image-overlay"
                            data-bs-toggle="modal"
                            data-bs-target="#fullImageModal"
                            onclick="setModalImage('{{ pos.image.url }}' , '{{ pos.user }}' )">

                            <div class="post-card__overlay-content">
                                <a href="/profile/{{pos.user}}" class="post-card__overlay-username">
                                    @{{pos.user}}
                                </a>
                                {% if pos.caption %}
                                <p class="post-card__overlay-caption">
                                    {{pos.caption|truncatechars:100}}
                                </p>
                                {% endif %}
                            </div>
                        </div>

                    </div>
                    {% endif %}
                </div>
                
                <!-- Footer -->
                <footer class="post-card__footer">
                    <div class="post-card__stats">
                        <div class="post-card__stat">
                            <i class="fas fa-heart post-card__stat-icon"></i>
                            <span>{{pos.no_of_like}}</span>
                        </div>
                        <div class="post-card__stat">
                            <i class="fas fa-comment post-card__stat-icon"></i>
                            <span>{{pos.comments.count}}</span>
                        </div>
                    </div>
                    
                    <div class="post-card__actions-bar">
                        <a href="{% url 'like-post' pos.id %}?from=liked_list " style="text-decoration: none;" class="post-card__action post-card__action--like {% if pos.is_liked %}post-card__action--active{% endif %}" data-post-id="{{pos.id}}">
                            <i class="{% if pos.is_liked %}fas fa-heart{% else %}far fa-heart{% endif %}"></i>
                            <span>Like</span>
                        </a>
                        </button>
                        
                        <button class="post-card__action post-card__action--comment">
                            <i class="fas fa-comment post-card__action-icon"></i>
                            <span class="post-card__action-text">Comment</span>
                        </button>
                        
                        <button class="post-card__action post-card__action--share">
                            <i class="fas fa-share-alt post-card__action-icon"></i>
                            <span class="post-card__action-text">Share</span>
                        </button>
                    </div>
                </footer>
            </article>
        
            {% endfor %}
    {% else %}
        <h1 class="h2 font-bold gradient-text">You haven't liked any posts yet.</h1>   
        <p></p>
    {% endif %}
            </main>
    
</div>


<!-- Modal for full image display -->
<div class="modal fade" id="fullImageModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                
                <h5 class="modal-title" id="modalProfileName" style="color:black; font:bold;"></h5>
                {% comment %} <h5 class="modal-title">{{ pos.user_profile.profilename }}</h5> {% endcomment %}
                
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-0 text-center">
                <img id="modalImage" class="img-fluid w-100 rounded" src="">
            </div>
        </div>
    </div>
</div>

<script>
  
function setModalImage(src , profileName) {
    document.getElementById("modalImage").src = src;
    document.getElementById("modalProfileName").textContent = profileName;
}
</script>
{% endblock %}